use remote_compose_expressions::remote_path::RemotePath;

#[test]
fn test_remote_path_parsing_repro_color_filter2() {
    // Extracted from failure in testColorFilter2
    // This is the raw Big Endian data as read from the data_path
    let data: [u8; 320] = [
        0xFF, 0x80, 0x00, 0x0A, 0x42, 0xE6, 0xAF, 0x1B, 0x43, 0x3C, 0x03, 0xD7, 0xFF, 0x80, 0x00,
        0x0E, 0x42, 0xE6, 0xAF, 0x1B, 0x43, 0x3C, 0x03, 0xD7, 0x42, 0xD8, 0xA2, 0x4E, 0x43, 0x3C,
        0x03, 0xD7, 0x42, 0xCD, 0x33, 0xB7, 0x43, 0x41, 0xBB, 0x23, 0x42, 0xCD, 0x33, 0xB7, 0x43,
        0x48, 0xC1, 0x89, 0xFF, 0x80, 0x00, 0x0E, 0x42, 0xCD, 0x33, 0xB7, 0x43, 0x48, 0xC1, 0x89,
        0x42, 0xCD, 0x33, 0xB7, 0x43, 0x4F, 0xC7, 0xEF, 0x42, 0xD8, 0xA2, 0x4F, 0x43, 0x55, 0x7F,
        0x3B, 0x42, 0xE6, 0xAF, 0x1B, 0x43, 0x55, 0x7F, 0x3B, 0xFF, 0x80, 0x00, 0x0E, 0x42, 0xE6,
        0xAF, 0x1B, 0x43, 0x55, 0x7F, 0x3B, 0x42, 0xF4, 0xBC, 0x6B, 0x43, 0x55, 0x7F, 0x3B, 0x43,
        0x00, 0x15, 0x81, 0x43, 0x4F, 0xC7, 0xEF, 0x43, 0x00, 0x15, 0x81, 0x43, 0x48, 0xC1, 0x89,
        0xFF, 0x80, 0x00, 0x0E, 0x43, 0x00, 0x15, 0x81, 0x43, 0x48, 0xC1, 0x89, 0x43, 0x00, 0x15,
        0x81, 0x43, 0x41, 0xBB, 0x23, 0x42, 0xF4, 0xBC, 0x6A, 0x43, 0x3C, 0x03, 0xD7, 0x42, 0xE6,
        0xAF, 0x1B, 0x43, 0x3C, 0x03, 0xD7, 0xFF, 0x80, 0x00, 0x0F, 0xFF, 0x80, 0x00, 0x0A, 0x42,
        0xE6, 0xAF, 0x1B, 0x43, 0x4D, 0x7F, 0x3B, 0xFF, 0x80, 0x00, 0x0E, 0x42, 0xE6, 0xAF, 0x1B,
        0x43, 0x4D, 0x7F, 0x3B, 0x42, 0xE1, 0x74, 0xBD, 0x43, 0x4D, 0x7F, 0x3B, 0x42, 0xDD, 0x33,
        0xB7, 0x43, 0x4B, 0x5E, 0xB8, 0x42, 0xDD, 0x33, 0xB7, 0x43, 0x48, 0xC1, 0x89, 0xFF, 0x80,
        0x00, 0x0E, 0x42, 0xDD, 0x33, 0xB7, 0x43, 0x48, 0xC1, 0x89, 0x42, 0xDD, 0x33, 0xB7, 0x43,
        0x46, 0x24, 0x5A, 0x42, 0xE1, 0x74, 0xBD, 0x43, 0x44, 0x03, 0xD7, 0x42, 0xE6, 0xAF, 0x1B,
        0x43, 0x44, 0x03, 0xD7, 0xFF, 0x80, 0x00, 0x0E, 0x42, 0xE6, 0xAF, 0x1B, 0x43, 0x44, 0x03,
        0xD7, 0x42, 0xEB, 0xE9, 0xFC, 0x43, 0x44, 0x03, 0xD7, 0x42, 0xF0, 0x2B, 0x02, 0x43, 0x46,
        0x24, 0x5A, 0x42, 0xF0, 0x2B, 0x02, 0x43, 0x48, 0xC1, 0x89, 0xFF, 0x80, 0x00, 0x0E, 0x42,
        0xF0, 0x2B, 0x02, 0x43, 0x48, 0xC1, 0x89, 0x42, 0xF0, 0x2B, 0x02, 0x43, 0x4B, 0x5E, 0xB8,
        0x42, 0xEB, 0xE9, 0xFC, 0x43, 0x4D, 0x7F, 0x3B, 0x42, 0xE6, 0xAF, 0x1B, 0x43, 0x4D, 0x7F,
        0x3B, 0xFF, 0x80, 0x00, 0x0F,
    ];

    let (path, read) = RemotePath::read(&data).expect("Failed to read RemotePath");
    assert_eq!(read, data.len());

    println!("Parsed path ops: {:?}", path.ops);
    assert!(!path.ops.is_empty());
}
